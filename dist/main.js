(()=>{"use strict";function e(e,t){e.fontSize=t.fontSize,e.fontName={family:t.fontFamily,style:"Regular"},e.textAlignHorizontal=t.textAlign.toUpperCase(),e.textAutoResize="WIDTH_AND_HEIGHT"}function t(e,t,a,i){t.push(e.name),a.push({layerName:e.name,time:(new Date).toISOString()}),function(e){let t;return function(...a){clearTimeout(t),t=setTimeout((()=>e.apply(this,a)),300)}}((()=>{figma.notify(`Automatically logged click on: ${e.name}`,{timeout:1e3})}))(),figma.ui.postMessage({type:"update-click-history",clickedLayers:t})}figma.showUI(__html__),figma.ui.resize(450,600);let a=[],i=[];figma.on("selectionchange",(()=>{const e=figma.currentPage.selection;e.length>0&&t(e[0],a,i)})),figma.ui.onmessage=n=>{if("log-click"===n.type){const e=figma.currentPage.selection;e.length>0?t(e[0],a,i):figma.notify("Please select a layer to log the click.")}else"generate-heatmap"===n.type?function(e){const t=e.reduce(((e,t)=>(e[t]=(e[t]||0)+1,e)),{});figma.ui.postMessage({type:"display-heatmap",heatmapData:t})}(a):"clear-history"===n.type?function(e,t){e.length=0,t.length=0,figma.notify("Click history cleared."),figma.ui.postMessage({type:"clear-history"})}(a,i):"export-data"===n.type&&async function(t){try{await figma.loadFontAsync({family:"Inter",style:"Regular"});const a=figma.createPage();a.name="UX Click Data Report",figma.currentPage=a;let i=40;const n=40,o=figma.createText();o.characters="UX Interaction Report: Click Data Analysis",e(o,{fontFamily:"Inter",fontSize:32,textAlign:"LEFT"}),o.x=n,o.y=i,a.appendChild(o),i+=50;const c=figma.createText(),l=new Set(t).size,r=t.length;c.characters=`This report captures a total of ${r} clicks across ${l} unique layers.`,e(c,{fontFamily:"Inter",fontSize:16,textAlign:"LEFT"}),c.x=n,c.y=i,a.appendChild(c),i+=80;const s=t.reduce(((e,t)=>(e[t]=(e[t]||0)+1,e)),{});for(const[t,o]of Object.entries(s)){const c=figma.createText();c.characters=`Layer: ${t}\nClicks: ${o}`,e(c,{fontFamily:"Inter",fontSize:16,textAlign:"LEFT"}),c.x=n,c.y=i,a.appendChild(c),i+=50}figma.notify("Click data report has been created successfully.")}catch(e){console.error("Error exporting click data:",e),figma.notify("Failed to export click data. Please try again.")}}(a)}})();